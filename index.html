<!DOCTYPE html>
<html>
<head>
  <title>QuoteX Signal Bot</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body{font-family:Arial,sans-serif;background:#f0f4f8;text-align:center;padding:20px;}
    h1{color:#2c3e50;}
    select,button{padding:10px;margin:10px;font-size:16px;}
    #signal{font-size:24px;font-weight:bold;margin-top:20px;color:#e74c3c;}
    .arrow{font-size:40px;animation:bounce 1s infinite;}
    @keyframes bounce{0%{transform:translateY(0);}50%{transform:translateY(-10px);}100%{transform:translateY(0);}}
  </style>
</head>
<body>

  <h1>ğŸ“¡ QuoteX Signal Bot</h1>

  <!-- Live Pairs -->
  <label><strong>Live Market Pairs:</strong></label><br>
  <select id="livePair">
    <option value="">Loading Live Pairs...</option>
  </select>

  <br><br>

  <!-- OTC Pairs -->
  <label><strong>OTC Market Pairs:</strong></label><br>
  <select id="otcPair">
    <option value="">Loading OTC Pairs...</option>
  </select>

  <br><br>

  <!-- Timeframes -->
  <label><strong>Timeframe:</strong></label><br>
  <select id="timeframe">
    <option value="5s">5 Seconds</option>
    <option value="10s">10 Seconds</option>
    <option value="15s">15 Seconds</option>
    <option value="30s">30 Seconds</option>
    <option value="1m">1 Minute</option>
  </select>

  <br><br>
  <button onclick="analyzeMarket()">ğŸ“ˆ Analyze Market</button>

  <div id="signal">Waiting...</div>

  <audio id="buySound"  src="buy.mp3"  preload="auto"></audio>
  <audio id="sellSound" src="sell.mp3" preload="auto"></audio>

  <script>
    <script>
  /* Ø§ÛŒÚ© ÛÛŒ Ø¬Ú¯Û backend Ú©Ø§ Ù„Ù†Ú© Ù„Ú©Ú¾ Ø¯ÛŒÚº */
  const BACKEND = "https://3000-adeel720-backend-r9fleuj0zva.ws-us120.gitpod.io";

  // -----------------  1)  Ù¾ÛŒØ¦Ø±Ø² Ù„ÙˆÚˆ Ú©Ø±Ù†Ø§  -----------------
  async function loadPairs() {
    try {
      const res  = await fetch(`${BACKEND}/api/pairs`);
      const data = await res.json();

      const liveSel = document.getElementById("livePair");
      const otcSel  = document.getElementById("otcPair");
      liveSel.innerHTML = "<option value=''>-- Select Live Pair --</option>";
      otcSel.innerHTML  = "<option value=''>-- Select OTC Pair --</option>";

      data.pairs.forEach(pair => {
        const opt = new Option(pair, pair);
        if (pair.includes("OTC")) {
          otcSel.appendChild(opt);
        } else {
          liveSel.appendChild(opt);
        }
      });
    } catch (err) {
      console.error("Pairs fetch error:", err);
      document.getElementById("livePair").innerHTML = "<option>Error loading</option>";
      document.getElementById("otcPair").innerHTML  = "<option>Error loading</option>";
    }
  }

  // ØµÙØ­Û Ù„ÙˆÚˆ ÛÙˆØªÛ’ ÛÛŒ Ú©Ø§Ù„ Ú©Ø±ÛŒÚº
  window.onload = loadPairs;
</script>

    // ØµÙØ­Û Ù„ÙˆÚˆ ÛÙˆØªÛ’ ÛÛŒ Ú©Ø§Ù„ Ú©Ø±ÛŒÚº
    loadPairs();

    // -----------------  2)  Ø§Ù†Ø§Ù„Ø§Ø¦Ø² Ù…Ø§Ø±Ú©Ù¹ ÙÙ†Ú©Ø´Ù†  -----------------
    async function analyzeMarket() {
      const livePair = document.getElementById("livePair").value;
      const otcPair  = document.getElementById("otcPair").value;
      const pair     = livePair || otcPair;
      const timeframe= document.getElementById("timeframe").value;

      if (!pair) {
        alert("Please select a pair from Live or OTC");
        return;
      }

      document.getElementById("signal").innerText = "ğŸ”„ Fetching...";

      try {
        const response = await fetch("https://3000-adeel720-backend-r9fleuj0zva.ws-us120.gitpod.io/signal", {
          method: "POST",
          headers: {"Content-Type": "application/json"},
          body: JSON.stringify({ pair, timeframe })
        });

        const data = await response.json();

        if (data.signal === "Buy" || data.signal === "buy") {
          document.getElementById("signal").innerHTML = "ğŸŸ¢ BUY Signal<br><div class='arrow'>â¬†ï¸</div>";
          document.getElementById("buySound").play();
        } else if (data.signal === "Sell" || data.signal === "sell") {
          document.getElementById("signal").innerHTML = "ğŸ”´ SELL Signal<br><div class='arrow'>â¬‡ï¸</div>";
          document.getElementById("sellSound").play();
        } else {
          document.getElementById("signal").innerHTML = "âš ï¸ No Signal";
        }

      } catch (error) {
        console.error("âŒ Error fetching data:", error);
        document.getElementById("signal").innerText = "âŒ Error fetching data";
      }
    }
  </script>

</body>
</html>
